import{c as k,f as $,k as O,l as P,m as j,p as F}from"./chunk-OYOJ2XX2.js";import{a as N}from"./chunk-NHNZC5T7.js";import{a as V}from"./chunk-ZS4G4JJV.js";import{a as c,b as L}from"./chunk-4QFA7BNO.js";import{$a as v,Aa as y,Oa as g,P as b,Pb as T,Qa as s,Qb as M,Ra as C,Rb as U,U as D,Ua as t,Va as i,Wa as d,Wb as H,_ as w,_a as S,eb as n,fb as p,gb as u,ja as f,jb as _,ka as x,kb as A,lb as I,nb as R,za as o}from"./chunk-CZ4BJCOO.js";var B=(()=>{class a{constructor(e){this.http=e,this.apiUrl=`${V.apiUrl}/admin`}getReports(e="month"){let l=new c().set("period",e);return this.http.get(`${this.apiUrl}/reports`,{params:l})}exportReport(e="month"){let l=new c().set("period",e);return this.http.get(`${this.apiUrl}/reports/export`,{params:l,responseType:"blob"})}getSystemStats(){return this.http.get(`${this.apiUrl}/stats/system`)}getUserActivity(e="month"){let l=new c().set("period",e);return this.http.get(`${this.apiUrl}/stats/activity`,{params:l})}getPlatformUsage(e=6){let l=new c().set("months",e.toString());return this.http.get(`${this.apiUrl}/stats/usage`,{params:l})}getTopCompanies(e=5){let l=new c().set("limit",e.toString());return this.http.get(`${this.apiUrl}/stats/companies/top`,{params:l})}getSystemHealth(){return this.http.get(`${this.apiUrl}/stats/health`)}getAllAgreements(e=0,l=20){let r=new c().set("page",e.toString()).set("size",l.toString()).set("sort","createdAt,desc");return this.http.get(`${this.apiUrl}/agreements`,{params:r})}getPendingAgreements(e=0,l=10){let r=new c().set("page",e.toString()).set("size",l.toString()).set("sort","createdAt,asc");return this.http.get(`${this.apiUrl}/agreements/pending`,{params:r})}getAgreementStats(){return this.http.get(`${this.apiUrl}/stats/agreements`)}approveAgreement(e,l){return this.http.put(`${this.apiUrl}/agreements/${e}/approve`,l)}rejectAgreement(e,l){return this.http.put(`${this.apiUrl}/agreements/${e}/reject`,l)}static{this.\u0275fac=function(l){return new(l||a)(D(L))}}static{this.\u0275prov=b({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();function W(a,m){a&1&&(t(0,"div",38),d(1,"div",39),i())}function q(a,m){if(a&1&&(t(0,"div",40)(1,"div",1)(2,"span",41),n(3,"Connexions aujourd'hui"),i(),t(4,"span",42),n(5),i()(),t(6,"div",1)(7,"span",41),n(8,"Connexions cette semaine"),i(),t(9,"span",43),n(10),i()(),t(11,"div",1)(12,"span",41),n(13,"Connexions ce mois"),i(),t(14,"span",44),n(15),i()()()),a&2){let e=v();o(5),p((e.reportData==null||e.reportData.userActivity==null?null:e.reportData.userActivity.dailyLogins)||0),o(5),p((e.reportData==null||e.reportData.userActivity==null?null:e.reportData.userActivity.weeklyLogins)||0),o(5),p((e.reportData==null||e.reportData.userActivity==null?null:e.reportData.userActivity.monthlyLogins)||0)}}function J(a,m){a&1&&(t(0,"div",38),d(1,"div",39),i())}function X(a,m){if(a&1&&(t(0,"div",40)(1,"div",1)(2,"span",41),n(3,"Temps de fonctionnement"),i(),t(4,"span",43),n(5),i()(),t(6,"div",1)(7,"span",41),n(8,"Temps de r\xE9ponse moyen"),i(),t(9,"span",42),n(10),i()(),t(11,"div",1)(12,"span",41),n(13,"Taux d'erreur"),i(),t(14,"span",45),n(15),i()(),t(16,"div",1)(17,"span",41),n(18,"Utilisation stockage"),i(),t(19,"span",46),n(20),i()()()),a&2){let e=v();o(5),u("",(e.reportData==null||e.reportData.systemHealth==null?null:e.reportData.systemHealth.uptime)||0,"%"),o(5),u("",(e.reportData==null||e.reportData.systemHealth==null?null:e.reportData.systemHealth.responseTime)||0,"ms"),o(4),s("ngClass",((e.reportData==null||e.reportData.systemHealth==null?null:e.reportData.systemHealth.errorRate)||0)>5?"text-red-600":"text-green-600"),o(),u(" ",(e.reportData==null||e.reportData.systemHealth==null?null:e.reportData.systemHealth.errorRate)||0,"% "),o(5),u("",(e.reportData==null||e.reportData.systemHealth==null?null:e.reportData.systemHealth.storage)||0,"%")}}function Y(a,m){a&1&&(t(0,"div",38),d(1,"div",39),i())}function Z(a,m){if(a&1&&(t(0,"tr",49)(1,"td",52),n(2),i(),t(3,"td",53),n(4),i(),t(5,"td",54),n(6),i(),t(7,"td",55),n(8),i()()),a&2){let e=m.$implicit;o(2),p(e.month),o(2),p(e.users),o(2),p(e.offers),o(2),p(e.applications)}}function K(a,m){if(a&1&&(t(0,"div",47)(1,"table",48)(2,"thead")(3,"tr",49)(4,"th",50),n(5,"Mois"),i(),t(6,"th",50),n(7,"Utilisateurs"),i(),t(8,"th",50),n(9,"Offres"),i(),t(10,"th",50),n(11,"Candidatures"),i()()(),t(12,"tbody"),g(13,Z,9,4,"tr",51),i()()()),a&2){let e=v();o(13),s("ngForOf",e.reportData==null?null:e.reportData.platformUsage)}}function Q(a,m){a&1&&(t(0,"div",56),d(1,"div",57),t(2,"p",58),n(3,"Chargement..."),i()())}function ee(a,m){if(a&1&&(t(0,"tr",64)(1,"td",65),n(2),i(),t(3,"td",66),n(4),i(),t(5,"td",66),n(6),i(),t(7,"td",66),n(8),i(),t(9,"td",67)(10,"div",13)(11,"div",68),d(12,"div",69),i(),t(13,"span",70),n(14),i()()()()),a&2){let e=m.$implicit,l=v(2);o(2),u(" ",e.name," "),o(2),u(" ",e.offers," "),o(2),u(" ",e.applications," "),o(2),u(" ",e.rating,"/5 "),o(4),C("width",e.rating/5*100,"%"),o(2),u(" ",l.getPerformanceLabel(e.rating)," ")}}function te(a,m){if(a&1&&(t(0,"div",47)(1,"table",59)(2,"thead",60)(3,"tr")(4,"th",61),n(5," Entreprise "),i(),t(6,"th",61),n(7," Offres publi\xE9es "),i(),t(8,"th",61),n(9," Candidatures re\xE7ues "),i(),t(10,"th",61),n(11," Note moyenne "),i(),t(12,"th",61),n(13," Performance "),i()()(),t(14,"tbody",62),g(15,ee,15,7,"tr",63),i()()()),a&2){let e=v();o(15),s("ngForOf",e.reportData==null?null:e.reportData.topCompanies)}}var me=(()=>{class a{constructor(e,l){this.adminReportsService=e,this.notificationService=l,this.reportData=null,this.selectedPeriod="month",this.loading=!0}ngOnInit(){this.loadReports()}loadReports(){this.loading=!0,this.adminReportsService.getReports(this.selectedPeriod).subscribe({next:e=>{this.reportData=e,this.loading=!1},error:e=>{console.error("Error loading reports:",e),this.notificationService.showError("Erreur lors du chargement des rapports"),this.loading=!1,this.reportData=this.getMockData()}})}exportReport(){this.adminReportsService.exportReport(this.selectedPeriod).subscribe({next:e=>{let l=window.URL.createObjectURL(e),r=document.createElement("a");r.href=l,r.download=`rapport-admin-${this.selectedPeriod}-${new Date().toISOString().split("T")[0]}.pdf`,r.click(),window.URL.revokeObjectURL(l),this.notificationService.showSuccess("Rapport export\xE9 avec succ\xE8s")},error:e=>{console.error("Error exporting report:",e),this.notificationService.showError("Erreur lors de l'export")}})}getPerformanceLabel(e){return e>=4.5?"Excellent":e>=4?"Tr\xE8s bien":e>=3.5?"Bien":e>=3?"Correct":"\xC0 am\xE9liorer"}getMockData(){return{systemStats:{totalUsers:456,totalStudents:245,totalCompanies:67,totalFaculty:23,totalOffers:189,totalApplications:567,totalAgreements:234},userActivity:{dailyLogins:89,weeklyLogins:234,monthlyLogins:1245},platformUsage:[{month:"Janvier",users:234,offers:45,applications:123},{month:"F\xE9vrier",users:267,offers:52,applications:145},{month:"Mars",users:289,offers:48,applications:167},{month:"Avril",users:312,offers:61,applications:189},{month:"Mai",users:345,offers:58,applications:201}],topCompanies:[{name:"TechCorp Solutions",offers:25,applications:89,rating:4.8},{name:"InnovateLab",offers:18,applications:67,rating:4.6},{name:"DataSolutions Inc",offers:15,applications:54,rating:4.4},{name:"WebAgency Pro",offers:12,applications:43,rating:4.2},{name:"StartupXYZ",offers:10,applications:38,rating:4}],systemHealth:{uptime:99.8,responseTime:245,errorRate:.2,storage:67},agreementStats:{totalAgreements:234,pendingAgreements:45,approvedAgreements:189,rejectedAgreements:12,signedAgreements:156}}}static{this.\u0275fac=function(l){return new(l||a)(y(B),y(N))}}static{this.\u0275cmp=w({type:a,selectors:[["app-admin-reports"]],standalone:!0,features:[R],decls:82,vars:13,consts:[[1,"space-y-6"],[1,"flex","justify-between","items-center"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-600"],[1,"flex","space-x-2"],[1,"px-3","py-2","border","border-gray-300","rounded-md",3,"ngModelChange","change","ngModel"],["value","week"],["value","month"],["value","quarter"],["value","year"],[1,"px-4","py-2","bg-primary-600","text-white","rounded-md","hover:bg-primary-700",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-6"],[1,"bg-white","p-6","rounded-lg","shadow"],[1,"flex","items-center"],[1,"p-2","bg-primary-100","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-primary-600"],["d","M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"],[1,"ml-4"],[1,"text-sm","font-medium","text-gray-600"],[1,"text-2xl","font-semibold","text-gray-900"],[1,"p-2","bg-green-100","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-green-600"],["d","M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2-2v2m8 0V6a2 2 0 012 2v6a2 2 0 01-2 2H8a2 2 0 01-2-2V8a2 2 0 012-2V6"],[1,"p-2","bg-yellow-100","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-yellow-600"],["d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"p-2","bg-purple-100","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-purple-600"],["d","M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6"],[1,"text-lg","font-medium","text-gray-900","mb-4"],["class","flex justify-center py-8",4,"ngIf"],["class","space-y-4",4,"ngIf"],["class","overflow-x-auto",4,"ngIf"],[1,"bg-white","shadow","rounded-lg"],[1,"px-6","py-4","border-b","border-gray-200"],[1,"text-lg","font-medium","text-gray-900"],["class","p-6 text-center",4,"ngIf"],[1,"flex","justify-center","py-8"],[1,"animate-spin","rounded-full","h-8","w-8","border-b-2","border-primary-600"],[1,"space-y-4"],[1,"text-sm","text-gray-600"],[1,"text-lg","font-semibold","text-primary-600"],[1,"text-lg","font-semibold","text-green-600"],[1,"text-lg","font-semibold","text-purple-600"],[1,"text-lg","font-semibold",3,"ngClass"],[1,"text-lg","font-semibold","text-orange-600"],[1,"overflow-x-auto"],[1,"min-w-full"],[1,"border-b"],[1,"text-left","py-2","text-sm","font-medium","text-gray-600"],["class","border-b",4,"ngFor","ngForOf"],[1,"py-2","text-sm","text-gray-900"],[1,"py-2","text-sm","text-primary-600"],[1,"py-2","text-sm","text-green-600"],[1,"py-2","text-sm","text-purple-600"],[1,"p-6","text-center"],[1,"animate-spin","rounded-full","h-8","w-8","border-b-2","border-primary-600","mx-auto"],[1,"mt-2","text-gray-600"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],["class","hover:bg-gray-50",4,"ngFor","ngForOf"],[1,"hover:bg-gray-50"],[1,"px-6","py-4","whitespace-nowrap","text-sm","font-medium","text-gray-900"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-900"],[1,"px-6","py-4","whitespace-nowrap"],[1,"w-16","bg-gray-200","rounded-full","h-2"],[1,"bg-primary-600","h-2","rounded-full"],[1,"ml-2","text-sm","text-gray-600"]],template:function(l,r){l&1&&(t(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),n(4,"Rapports Syst\xE8me"),i(),t(5,"p",3),n(6,"Analyse globale de la plateforme et m\xE9triques syst\xE8me"),i()(),t(7,"div",4)(8,"select",5),I("ngModelChange",function(h){return A(r.selectedPeriod,h)||(r.selectedPeriod=h),h}),S("change",function(){return r.loadReports()}),t(9,"option",6),n(10,"Cette semaine"),i(),t(11,"option",7),n(12,"Ce mois"),i(),t(13,"option",8),n(14,"Ce trimestre"),i(),t(15,"option",9),n(16,"Cette ann\xE9e"),i()(),t(17,"button",10),S("click",function(){return r.exportReport()}),n(18," Exporter Rapport "),i()()(),t(19,"div",11)(20,"div",12)(21,"div",13)(22,"div",14),f(),t(23,"svg",15),d(24,"path",16),i()(),x(),t(25,"div",17)(26,"p",18),n(27,"Utilisateurs totaux"),i(),t(28,"p",19),n(29),i()()()(),t(30,"div",12)(31,"div",13)(32,"div",20),f(),t(33,"svg",21),d(34,"path",22),i()(),x(),t(35,"div",17)(36,"p",18),n(37,"Offres actives"),i(),t(38,"p",19),n(39),i()()()(),t(40,"div",12)(41,"div",13)(42,"div",23),f(),t(43,"svg",24),d(44,"path",25),i()(),x(),t(45,"div",17)(46,"p",18),n(47,"Candidatures"),i(),t(48,"p",19),n(49),i()()()(),t(50,"div",12)(51,"div",13)(52,"div",26),f(),t(53,"svg",27),d(54,"path",28),i()(),x(),t(55,"div",17)(56,"p",18),n(57,"Conventions"),i(),t(58,"p",19),n(59),i()()()()(),t(60,"div",29)(61,"div",12)(62,"h3",30),n(63,"Activit\xE9 des utilisateurs"),i(),g(64,W,2,0,"div",31)(65,q,16,3,"div",32),i(),t(66,"div",12)(67,"h3",30),n(68,"Sant\xE9 du syst\xE8me"),i(),g(69,J,2,0,"div",31)(70,X,21,5,"div",32),i()(),t(71,"div",12)(72,"h3",30),n(73,"\xC9volution de l'utilisation"),i(),g(74,Y,2,0,"div",31)(75,K,14,1,"div",33),i(),t(76,"div",34)(77,"div",35)(78,"h3",36),n(79,"Top Entreprises"),i()(),g(80,Q,4,0,"div",37)(81,te,16,1,"div",33),i()()),l&2&&(o(8),_("ngModel",r.selectedPeriod),o(21),p((r.reportData==null||r.reportData.systemStats==null?null:r.reportData.systemStats.totalUsers)||0),o(10),p((r.reportData==null||r.reportData.systemStats==null?null:r.reportData.systemStats.totalOffers)||0),o(10),p((r.reportData==null||r.reportData.systemStats==null?null:r.reportData.systemStats.totalApplications)||0),o(10),p((r.reportData==null||r.reportData.systemStats==null?null:r.reportData.systemStats.totalAgreements)||0),o(5),s("ngIf",r.loading),o(),s("ngIf",!r.loading&&(r.reportData==null?null:r.reportData.userActivity)),o(4),s("ngIf",r.loading),o(),s("ngIf",!r.loading&&(r.reportData==null?null:r.reportData.systemHealth)),o(4),s("ngIf",r.loading),o(),s("ngIf",!r.loading&&(r.reportData==null?null:r.reportData.platformUsage)),o(5),s("ngIf",r.loading),o(),s("ngIf",!r.loading&&(r.reportData==null?null:r.reportData.topCompanies)))},dependencies:[H,T,M,U,F,P,j,O,k,$]})}}return a})();export{me as AdminReportsComponent};
