import{a as z,c as H,d as q,e as G,f as R,g as X,k as J,l as K,m as Q,n as Y,p as Z}from"./chunk-OYOJ2XX2.js";import{a as ee}from"./chunk-NHNZC5T7.js";import{f as $}from"./chunk-KFQQY7Q4.js";import"./chunk-ZS4G4JJV.js";import{a as W,b as M}from"./chunk-4QFA7BNO.js";import{$a as d,Aa as O,Oa as y,P as L,Pb as j,Qa as m,Qb as N,Rb as F,U as k,Ua as t,Ub as U,Va as i,Wa as b,Wb as B,Za as E,_ as I,_a as f,eb as r,fb as p,gb as h,ha as u,hb as T,ia as g,ja as v,jb as S,ka as _,kb as C,lb as w,nb as A,ob as D,rb as V,tb as P,za as s}from"./chunk-CZ4BJCOO.js";var te=(()=>{class l{constructor(e){this.http=e,this.baseUrl="http://localhost:8080/api"}getAllOffers(){return console.log("Appel API vers:",`${this.baseUrl}/offers`),this.http.get(`${this.baseUrl}/offers`)}getOfferById(e){return this.http.get(`${this.baseUrl}/offers/${e}`)}createApplication(e,o,n){let a=new FormData;return a.append("coverLetter",o),a.append("cv",n),this.http.post(`${this.baseUrl}/offers/${e}/apply`,a)}createOffer(e){return this.http.post(`${this.baseUrl}/offers`,e)}getCompanyOffers(e=0,o=10){let n=new W().set("page",e.toString()).set("size",o.toString()).set("sort","createdAt,desc");return this.http.get(`${this.baseUrl}/companies/me/offers`,{params:n})}getApplicationsByStudent(){return this.http.get(`${this.baseUrl}/students/me/applications`)}getAgreementsByStudent(){return console.log("Appel API vers:",`${this.baseUrl}/agreements`),this.http.get(`${this.baseUrl}/agreements`)}signAgreement(e,o){return this.http.put(`${this.baseUrl}/agreements/${e}/validate`,o)}updateOffer(e){return this.http.put(`${this.baseUrl}/offers/${e.id}`,e)}deleteOffer(e){return this.http.delete(`${this.baseUrl}/offers/${e}`)}static{this.\u0275fac=function(o){return new(o||l)(k(M))}}static{this.\u0275prov=L({token:l,factory:l.\u0275fac,providedIn:"root"})}}return l})();var oe=l=>["/student/apply",l];function se(l,x){if(l&1&&(t(0,"option",15),r(1),i()),l&2){let e=x.$implicit;m("value",e),s(),p(e)}}function le(l,x){if(l&1){let e=E();t(0,"div",16)(1,"div",17)(2,"span",18),r(3),i(),t(4,"button",19),v(),t(5,"svg",20),b(6,"path",21),i()()(),_(),t(7,"h3",22),r(8),i(),t(9,"p",23),r(10),i(),t(11,"div",24)(12,"p",25),r(13),i(),t(14,"div",26),v(),t(15,"svg",27),b(16,"path",28)(17,"path",29),i(),r(18),i(),_(),t(19,"div",30)(20,"div",31),v(),t(21,"svg",27),b(22,"path",32),i(),r(23),i(),_(),t(24,"span",33),r(25),i()(),t(26,"div",34),v(),t(27,"svg",27),b(28,"path",35),i(),r(29),i()(),_(),t(30,"div",36)(31,"button",37),f("click",function(){let n=u(e).$implicit,a=d();return g(a.viewDetails(n))}),r(32," Voir d\xE9tails "),i(),t(33,"a",38),r(34," Postuler "),i()()()}if(l&2){let e=x.$implicit,o=d();s(3),p(e.domain),s(5),p(e.title),s(2),h("Entreprise: ",e.companyName,""),s(3),p(e.description),s(5),h(" ",e.location," "),s(5),h(" Dur\xE9e: ",e.duration," "),s(),m("ngClass",o.getStatusClass(e.statut)),s(),h(" ",e.statut," "),s(4),h(" ",e.salaire,"FCFA/mois "),s(4),m("routerLink",D(10,oe,e.id))}}function ae(l,x){l&1&&(t(0,"div",39)(1,"p",40),r(2,"Aucune offre trouv\xE9e"),i()())}function ce(l,x){if(l&1){let e=E();t(0,"div",41)(1,"div",42)(2,"div",43)(3,"h3",44),r(4),i(),t(5,"button",45),f("click",function(){u(e);let n=d();return g(n.closeModal())}),v(),t(6,"svg",46),b(7,"path",47),i()()(),_(),t(8,"div",48)(9,"div")(10,"h4",49),r(11,"Entreprise"),i(),t(12,"p",23),r(13),i()(),t(14,"div")(15,"h4",49),r(16,"Description"),i(),t(17,"p",23),r(18),i()(),t(19,"div")(20,"h4",49),r(21,"Comp\xE9tences requises"),i(),t(22,"p",23),r(23),i()(),t(24,"div",50)(25,"div")(26,"h4",49),r(27,"Lieu"),i(),t(28,"p",23),r(29),i()(),t(30,"div")(31,"h4",49),r(32,"Dur\xE9e"),i(),t(33,"p",23),r(34),i()(),t(35,"div")(36,"h4",49),r(37,"Salaire"),i(),t(38,"p",23),r(39),i()(),t(40,"div")(41,"h4",49),r(42,"Date de d\xE9but"),i(),t(43,"p",23),r(44),V(45,"date"),i()()()(),t(46,"div",51)(47,"button",52),f("click",function(){u(e);let n=d();return g(n.closeModal())}),r(48," Fermer "),i(),t(49,"button",53),f("click",function(){u(e);let n=d();return g(n.openApplicationModal(n.selectedOffer))}),r(50," Postuler "),i()()()()}if(l&2){let e=d();s(4),p(e.selectedOffer.titre),s(9),p(e.selectedOffer.companyName),s(5),p(e.selectedOffer.description),s(5),p(e.selectedOffer.competencesRequises),s(6),p(e.selectedOffer.lieu),s(5),h("",e.selectedOffer.duree," mois"),s(5),h("",e.selectedOffer.salaire,"\u20AC/mois"),s(5),p(P(45,8,e.selectedOffer.dateDebut,"dd/MM/yyyy"))}}function de(l,x){if(l&1){let e=E();t(0,"div",41)(1,"div",54)(2,"h3",55),r(3,"Postuler \xE0 l'offre"),i(),t(4,"p",56),r(5),i(),t(6,"form",57),f("ngSubmit",function(){u(e);let n=d();return g(n.submitApplication())}),t(7,"div",58)(8,"label",59),r(9,"Lettre de motivation"),i(),t(10,"textarea",60),w("ngModelChange",function(n){u(e);let a=d();return C(a.applicationData.lettreMotivation,n)||(a.applicationData.lettreMotivation=n),g(n)}),i()(),t(11,"div",61)(12,"button",62),f("click",function(){u(e);let n=d();return g(n.closeApplicationModal())}),r(13," Annuler "),i(),t(14,"button",63),r(15," Envoyer candidature "),i()()()()()}if(l&2){let e=d();s(5),T("",e.selectedOffer==null?null:e.selectedOffer.titre," - ",e.selectedOffer==null?null:e.selectedOffer.companyName,""),s(5),S("ngModel",e.applicationData.lettreMotivation),s(4),m("disabled",!e.applicationData.lettreMotivation.trim())}}var ve=(()=>{class l{constructor(e,o,n){this.internshipService=e,this.notificationService=o,this.http=n,this.offers=[],this.filteredOffers=[],this.selectedOffer=null,this.showApplicationModal=!1,this.applicationData={lettreMotivation:""},this.searchTerm="",this.selectedLocation="",this.selectedDuration="",this.locations=[],console.log("\u{1F680} OffersListComponent constructor appel\xE9")}ngOnInit(){console.log("\u{1F680} OffersListComponent ngOnInit() appel\xE9"),this.testPublicEndpoints(),this.loadOffers()}testPublicEndpoints(){console.log("=== TEST DES ENDPOINTS PUBLICS ==="),console.log("Appel vers /api/skills..."),this.http.get("http://localhost:8080/api/skills").subscribe({next:e=>console.log("\u2705 Skills re\xE7ues:",e),error:e=>console.error("\u274C Erreur skills:",e)}),console.log("Appel vers /api/domains..."),this.http.get("http://localhost:8080/api/domains").subscribe({next:e=>console.log("\u2705 Domains re\xE7ues:",e),error:e=>console.error("\u274C Erreur domains:",e)}),console.log("Appel vers /api/offers..."),this.http.get("http://localhost:8080/api/offers").subscribe({next:e=>console.log("\u2705 Offers re\xE7ues:",e),error:e=>console.error("\u274C Erreur offers:",e)})}loadOffers(){console.log("Tentative de chargement des offres..."),this.internshipService.getAllOffers().subscribe({next:e=>{console.log("Donn\xE9es re\xE7ues du backend:",e),this.offers=e.content||e,this.filteredOffers=[...this.offers],this.locations=[...new Set(this.offers.map(o=>o.location||o.lieu))],console.log("Offres trait\xE9es:",this.offers)},error:e=>{console.error("Erreur compl\xE8te:",e),console.error("Status:",e.status),console.error("Message:",e.message),this.notificationService.showError("Erreur lors du chargement des offres: "+e.message)}})}filterOffers(){this.filteredOffers=this.offers.filter(e=>{let o=!this.searchTerm||e.titre.toLowerCase().includes(this.searchTerm.toLowerCase())||e.companyName?.toLowerCase().includes(this.searchTerm.toLowerCase())||e.description.toLowerCase().includes(this.searchTerm.toLowerCase()),n=!this.selectedLocation||e.lieu===this.selectedLocation,a=!this.selectedDuration||e.duree.toString()===this.selectedDuration;return o&&n&&a})}viewDetails(e){this.selectedOffer=e}applyToOffer(e){this.openApplicationModal(e)}closeModal(){this.selectedOffer=null}openApplicationModal(e){this.selectedOffer=e,this.showApplicationModal=!0,this.applicationData.lettreMotivation="",this.closeModal()}closeApplicationModal(){this.showApplicationModal=!1,this.selectedOffer=null,this.applicationData.lettreMotivation=""}submitApplication(){if(!this.selectedOffer||!this.applicationData.lettreMotivation.trim())return;let e=new File(["CV content"],"cv.pdf",{type:"application/pdf"});this.internshipService.createApplication(this.selectedOffer.id,this.applicationData.lettreMotivation,e).subscribe({next:()=>{this.notificationService.showSuccess("Candidature envoy\xE9e avec succ\xE8s"),this.closeApplicationModal()},error:o=>{console.error("Erreur:",o),this.notificationService.showError("Erreur lors de l'envoi de la candidature")}})}getStatusClass(e){return{ACTIVE:"bg-green-100 text-green-800",INACTIVE:"bg-gray-100 text-gray-800",EXPIRED:"bg-red-100 text-red-800"}[e]||"bg-gray-100 text-gray-800"}static{this.\u0275fac=function(o){return new(o||l)(O(te),O(ee),O(M))}}static{this.\u0275cmp=I({type:l,selectors:[["app-offers-list"]],standalone:!0,features:[A],decls:24,vars:8,consts:[[1,"space-y-6"],[1,"bg-white","rounded-lg","shadow-sm","border","p-6"],[1,"text-2xl","font-bold","text-primary-900"],[1,"mt-4","grid","grid-cols-1","md:grid-cols-3","gap-4"],["placeholder","Rechercher...",1,"border","border-gray-300","rounded-md","px-3","py-2",3,"ngModelChange","input","ngModel"],[1,"border","border-gray-300","rounded-md","px-3","py-2",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["value","3"],["value","6"],["value","12"],[1,"grid","gap-6","md:grid-cols-2","lg:grid-cols-3"],["class","bg-white rounded-lg shadow-sm border border-gray-200 p-6",4,"ngFor","ngForOf"],["class","text-center py-12",4,"ngIf"],["class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",4,"ngIf"],[3,"value"],[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200","p-6"],[1,"flex","justify-between","items-start","mb-2"],[1,"bg-orange-100","text-orange-800","text-xs","font-semibold","px-2.5","py-0.5","rounded-full"],[1,"text-gray-400","hover:text-red-500"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"],[1,"text-xl","mb-1","font-bold","text-primary-900"],[1,"text-gray-600"],[1,"space-y-3","my-4"],[1,"text-sm","text-gray-700","mb-4","line-clamp-3"],[1,"flex","items-center","text-sm","text-gray-600"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 11a3 3 0 11-6 0 3 3 0 016 0z"],[1,"flex","items-center","justify-between","text-sm","text-gray-600"],[1,"flex","items-center","mr-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"px-2","py-1","rounded-full","text-xs",3,"ngClass"],[1,"flex","items-center","justify-end","text-sm","text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"],[1,"flex","space-x-2"],[1,"flex-1","bg-primary-600","text-white","px-4","py-2","rounded-md","hover:bg-primary-700","text-sm",3,"click"],[1,"flex-1","bg-orange-500","text-white","px-4","py-2","rounded-md","hover:bg-orange-600","text-sm","text-center",3,"routerLink"],[1,"text-center","py-12"],[1,"text-gray-500"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"bg-white","rounded-lg","p-6","w-full","max-w-2xl","max-h-screen","overflow-y-auto"],[1,"flex","justify-between","items-start","mb-4"],[1,"text-xl","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"space-y-4"],[1,"font-medium","text-gray-900"],[1,"grid","grid-cols-2","gap-4"],[1,"flex","justify-end","space-x-2","mt-6"],[1,"px-4","py-2","text-gray-600","border","border-gray-300","rounded-md","hover:bg-gray-50",3,"click"],[1,"px-4","py-2","bg-orange-500","text-white","rounded-md","hover:bg-orange-600",3,"click"],[1,"bg-white","rounded-lg","p-6","w-full","max-w-lg"],[1,"text-xl","font-semibold","mb-4"],[1,"text-gray-600","mb-4"],[3,"ngSubmit"],[1,"mb-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["name","lettreMotivation","required","","rows","6","placeholder","Expliquez pourquoi vous \xEAtes int\xE9ress\xE9 par cette offre...",1,"w-full","border","border-gray-300","rounded-md","px-3","py-2",3,"ngModelChange","ngModel"],[1,"flex","justify-end","space-x-2"],["type","button",1,"px-4","py-2","text-gray-600","border","border-gray-300","rounded-md","hover:bg-gray-50",3,"click"],["type","submit",1,"px-4","py-2","bg-orange-500","text-white","rounded-md","hover:bg-orange-600","disabled:opacity-50",3,"disabled"]],template:function(o,n){o&1&&(t(0,"div",0)(1,"div",1)(2,"h1",2),r(3,"Offres de stage"),i(),t(4,"div",3)(5,"input",4),w("ngModelChange",function(c){return C(n.searchTerm,c)||(n.searchTerm=c),c}),f("input",function(){return n.filterOffers()}),i(),t(6,"select",5),w("ngModelChange",function(c){return C(n.selectedLocation,c)||(n.selectedLocation=c),c}),f("change",function(){return n.filterOffers()}),t(7,"option",6),r(8,"Toutes les villes"),i(),y(9,se,2,2,"option",7),i(),t(10,"select",5),w("ngModelChange",function(c){return C(n.selectedDuration,c)||(n.selectedDuration=c),c}),f("change",function(){return n.filterOffers()}),t(11,"option",6),r(12,"Toutes les dur\xE9es"),i(),t(13,"option",8),r(14,"3 mois"),i(),t(15,"option",9),r(16,"6 mois"),i(),t(17,"option",10),r(18,"12 mois"),i()()()(),t(19,"div",11),y(20,le,35,12,"div",12),i(),y(21,ae,3,0,"div",13),i(),y(22,ce,51,11,"div",14)(23,de,16,4,"div",14)),o&2&&(s(5),S("ngModel",n.searchTerm),s(),S("ngModel",n.selectedLocation),s(3),m("ngForOf",n.locations),s(),S("ngModel",n.selectedDuration),s(10),m("ngForOf",n.filteredOffers),s(),m("ngIf",n.filteredOffers.length===0),s(),m("ngIf",n.selectedOffer),s(),m("ngIf",n.showApplicationModal))},dependencies:[B,j,N,F,U,$,Z,X,K,Q,z,J,H,q,Y,R,G],styles:[".line-clamp-3[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%]{font-family:Merriweather,serif}p[_ngcontent-%COMP%], a[_ngcontent-%COMP%], li[_ngcontent-%COMP%], span[_ngcontent-%COMP%], div[_ngcontent-%COMP%], input[_ngcontent-%COMP%], button[_ngcontent-%COMP%]{font-family:Poppins,sans-serif}"]})}}return l})();export{ve as OffersListComponent};
