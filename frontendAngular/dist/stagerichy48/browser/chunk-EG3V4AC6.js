import{c as G,f as F,k as O,l as U,m as j,p as H}from"./chunk-OYOJ2XX2.js";import{a as $}from"./chunk-NHNZC5T7.js";import{f as L,i as P}from"./chunk-KFQQY7Q4.js";import{a as B}from"./chunk-SNFTPR3R.js";import"./chunk-ZS4G4JJV.js";import"./chunk-4QFA7BNO.js";import{$a as m,Aa as E,Oa as y,Pb as N,Qa as l,Qb as k,Rb as M,Ua as t,Va as i,Wa as u,Wb as D,Za as _,_ as b,_a as x,eb as n,fb as d,gb as h,ha as f,ia as S,ja as v,jb as w,ka as g,kb as I,lb as A,nb as T,ob as V,za as o}from"./chunk-CZ4BJCOO.js";var z=s=>["/admin/companies",s];function R(s,c){s&1&&(t(0,"div",36),u(1,"div",37),t(2,"p",38),n(3,"Chargement..."),i()())}function W(s,c){s&1&&(t(0,"div",39),n(1," Aucune entreprise trouv\xE9e "),i())}function q(s,c){if(s&1){let e=_();t(0,"button",60),x("click",function(){f(e);let a=m().$implicit,p=m(2);return S(p.approveCompany(a.id))}),n(1," Approuver "),i()}}function J(s,c){if(s&1){let e=_();t(0,"button",61),x("click",function(){f(e);let a=m().$implicit,p=m(2);return S(p.suspendCompany(a.id))}),n(1," Suspendre "),i()}}function K(s,c){if(s&1){let e=_();t(0,"button",60),x("click",function(){f(e);let a=m().$implicit,p=m(2);return S(p.activateCompany(a.id))}),n(1," R\xE9activer "),i()}}function Q(s,c){if(s&1&&(t(0,"tr",46)(1,"td",47)(2,"div",14)(3,"div",48)(4,"div",49)(5,"span",50),n(6),i()()(),t(7,"div",18)(8,"div",51),n(9),i(),t(10,"div",52),n(11),i()()()(),t(12,"td",47)(13,"div",53),n(14),i(),t(15,"div",52),n(16),i()(),t(17,"td",54),n(18),i(),t(19,"td",54),n(20),i(),t(21,"td",47)(22,"span",55),n(23),i()(),t(24,"td",56)(25,"div",5)(26,"button",57),n(27," Voir "),i(),y(28,q,2,0,"button",58)(29,J,2,0,"button",59)(30,K,2,0,"button",58),i()()()),s&2){let e=c.$implicit,r=m(2);o(6),h(" ",r.getCompanyInitials(e.name)," "),o(3),d(e.name),o(2),d(e.id),o(3),d(e.primaryContactUserEmail),o(2),d(e.address),o(2),h(" ",e.industrySector," "),o(2),h(" ",e.activeOffers||0," "),o(2),l("ngClass",r.getStatusClass(e.status)),o(),h(" ",r.getStatusLabel(e.status)," "),o(3),l("routerLink",V(13,z,e.id)),o(2),l("ngIf",e.status==="PENDING"),o(),l("ngIf",e.status==="ACTIVE"),o(),l("ngIf",e.status==="SUSPENDED")}}function X(s,c){if(s&1&&(t(0,"div",40)(1,"table",41)(2,"thead",42)(3,"tr")(4,"th",43),n(5," Entreprise "),i(),t(6,"th",43),n(7," Contact "),i(),t(8,"th",43),n(9," Secteur "),i(),t(10,"th",43),n(11," Offres actives "),i(),t(12,"th",43),n(13," Statut "),i(),t(14,"th",43),n(15," Actions "),i()()(),t(16,"tbody",44),y(17,Q,31,15,"tr",45),i()()()),s&2){let e=m();o(17),l("ngForOf",e.filteredCompanies)}}var se=(()=>{class s{constructor(e,r){this.apiService=e,this.notificationService=r,this.companies=[],this.filteredCompanies=[],this.selectedStatus="",this.loading=!0,this.stats={total:0,active:0,pending:0,suspended:0}}ngOnInit(){this.loadCompanies()}loadCompanies(){this.loading=!0,this.apiService.get("/admin/companies?size=1000").subscribe({next:e=>{this.companies=e.content||[],this.filteredCompanies=this.companies,this.calculateStats(),this.loading=!1},error:e=>{console.error("Error loading companies:",e),this.notificationService.showError("Erreur lors du chargement des entreprises"),this.loading=!1}})}filterCompanies(){this.selectedStatus?this.filteredCompanies=this.companies.filter(e=>e.status===this.selectedStatus):this.filteredCompanies=this.companies}calculateStats(){this.stats.total=this.companies.length,this.stats.active=this.companies.filter(e=>e.status==="ACTIVE").length,this.stats.pending=this.companies.filter(e=>e.status==="PENDING").length,this.stats.suspended=this.companies.filter(e=>e.status==="SUSPENDED").length}approveCompany(e){this.apiService.put(`/admin/companies/${e}/approve`,{}).subscribe({next:()=>{let r=this.companies.find(a=>a.id===e);r&&(r.status="ACTIVE",this.calculateStats(),this.filterCompanies()),this.notificationService.showSuccess("Entreprise approuv\xE9e avec succ\xE8s")},error:r=>{console.error("Error approving company:",r),this.notificationService.showError("Erreur lors de l'approbation")}})}suspendCompany(e){this.apiService.put(`/admin/companies/${e}/suspend`,{}).subscribe({next:()=>{let r=this.companies.find(a=>a.id===e);r&&(r.status="SUSPENDED",this.calculateStats(),this.filterCompanies()),this.notificationService.showSuccess("Entreprise suspendue")},error:r=>{console.error("Error suspending company:",r),this.notificationService.showError("Erreur lors de la suspension")}})}activateCompany(e){this.apiService.put(`/admin/companies/${e}/activate`,{}).subscribe({next:()=>{let r=this.companies.find(a=>a.id===e);r&&(r.status="ACTIVE",this.calculateStats(),this.filterCompanies()),this.notificationService.showSuccess("Entreprise r\xE9activ\xE9e")},error:r=>{console.error("Error activating company:",r),this.notificationService.showError("Erreur lors de la r\xE9activation")}})}exportCompanies(){}getStatusClass(e){switch(e){case"ACTIVE":return"bg-green-100 text-green-800";case"PENDING":return"bg-yellow-100 text-yellow-800";case"SUSPENDED":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}getStatusLabel(e){switch(e){case"ACTIVE":return"Active";case"PENDING":return"En attente";case"SUSPENDED":return"Suspendue";default:return e}}getCompanyInitials(e){return e.split(" ").map(r=>r.charAt(0)).join("").toUpperCase().slice(0,2)}static{this.\u0275fac=function(r){return new(r||s)(E(B),E($))}}static{this.\u0275cmp=b({type:s,selectors:[["app-admin-company"]],standalone:!0,features:[T],decls:68,vars:9,consts:[[1,"space-y-6"],[1,"flex","justify-between","items-center"],[1,"bg-white","flex","justify-between","w-full","rounded-lg","shadow-sm","border","p-6"],[1,"text-2xl","font-bold","text-primary-900","mb-2"],[1,"text-primary-600"],[1,"flex","space-x-2"],[1,"px-3","py-2","h-12","border","border-gray-300","rounded-md",3,"ngModelChange","change","ngModel"],[3,"ngValue"],["value","ACTIVE"],["value","PENDING"],["value","SUSPENDED"],[1,"px-4","py-2","bg-primary-600","h-12","text-white","rounded-md","hover:bg-primary-700",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-6"],[1,"bg-white","p-6","rounded-lg","shadow"],[1,"flex","items-center"],[1,"p-2","bg-primary-100","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-primry-600"],["d","M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"],[1,"ml-4"],[1,"text-sm","font-medium","text-gray-600"],[1,"text-2xl","font-semibold","text-gray-900"],[1,"p-2","bg-green-100","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-green-600"],["d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"p-2","bg-yellow-100","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-yellow-600"],["d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"p-2","bg-red-100","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-red-600"],["d","M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636m12.728 12.728L18.364 5.636M5.636 18.364l12.728-12.728"],[1,"bg-white","shadow","rounded-lg"],[1,"px-6","py-4","border-b","border-gray-200"],[1,"text-lg","font-medium","text-gray-900"],["class","p-6 text-center",4,"ngIf"],["class","p-6 text-center text-gray-500",4,"ngIf"],["class","overflow-x-auto",4,"ngIf"],[1,"p-6","text-center"],[1,"animate-spin","rounded-full","h-8","w-8","border-b-2","border-primary-600","mx-auto"],[1,"mt-2","text-gray-600"],[1,"p-6","text-center","text-gray-500"],[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],["class","hover:bg-gray-50",4,"ngFor","ngForOf"],[1,"hover:bg-gray-50"],[1,"px-6","py-4","whitespace-nowrap"],[1,"flex-shrink-0","h-10","w-10"],[1,"h-10","w-10","rounded-full","bg-primary-100","flex","items-center","justify-center"],[1,"text-sm","font-medium","text-primary-600"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"text-sm","text-gray-900"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-900"],[1,"px-2","inline-flex","text-xs","leading-5","font-semibold","rounded-full",3,"ngClass"],[1,"px-6","py-4","whitespace-nowrap","text-sm","font-medium"],[1,"text-primary-600","hover:text-primary-900",3,"routerLink"],["class","text-green-600 hover:text-green-900",3,"click",4,"ngIf"],["class","text-red-600 hover:text-red-900",3,"click",4,"ngIf"],[1,"text-green-600","hover:text-green-900",3,"click"],[1,"text-red-600","hover:text-red-900",3,"click"]],template:function(r,a){r&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"h1",3),n(5,"Gestion des Entreprises"),i(),t(6,"p",4),n(7,"Administration et supervision des entreprises partenaires"),i()(),t(8,"div",5)(9,"select",6),A("ngModelChange",function(C){return I(a.selectedStatus,C)||(a.selectedStatus=C),C}),x("change",function(){return a.filterCompanies()}),t(10,"option",7),n(11,"Tous les statuts"),i(),t(12,"option",8),n(13,"Actives"),i(),t(14,"option",9),n(15,"En attente"),i(),t(16,"option",10),n(17,"Suspendues"),i()(),t(18,"button",11),x("click",function(){return a.exportCompanies()}),n(19," Exporter "),i()()()(),t(20,"div",12)(21,"div",13)(22,"div",14)(23,"div",15),v(),t(24,"svg",16),u(25,"path",17),i()(),g(),t(26,"div",18)(27,"p",19),n(28,"Total"),i(),t(29,"p",20),n(30),i()()()(),t(31,"div",13)(32,"div",14)(33,"div",21),v(),t(34,"svg",22),u(35,"path",23),i()(),g(),t(36,"div",18)(37,"p",19),n(38,"Actives"),i(),t(39,"p",20),n(40),i()()()(),t(41,"div",13)(42,"div",14)(43,"div",24),v(),t(44,"svg",25),u(45,"path",26),i()(),g(),t(46,"div",18)(47,"p",19),n(48,"En attente"),i(),t(49,"p",20),n(50),i()()()(),t(51,"div",13)(52,"div",14)(53,"div",27),v(),t(54,"svg",28),u(55,"path",29),i()(),g(),t(56,"div",18)(57,"p",19),n(58,"Suspendues"),i(),t(59,"p",20),n(60),i()()()()(),t(61,"div",30)(62,"div",31)(63,"h3",32),n(64,"Liste des entreprises"),i()(),y(65,R,4,0,"div",33)(66,W,2,0,"div",34)(67,X,18,1,"div",35),i()()),r&2&&(o(9),w("ngModel",a.selectedStatus),o(),l("ngValue",""),o(20),d(a.stats.total),o(10),d(a.stats.active),o(10),d(a.stats.pending),o(10),d(a.stats.suspended),o(5),l("ngIf",a.loading),o(),l("ngIf",!a.loading&&a.filteredCompanies.length===0),o(),l("ngIf",!a.loading&&a.filteredCompanies.length>0))},dependencies:[D,N,k,M,H,U,j,O,G,F,P,L]})}}return s})();export{se as AdminCompanyComponent};
