import{a as W,c as L,d as j,e as D,f as O,g as P,k as B,l as H,m as R,n as G,p as q}from"./chunk-OYOJ2XX2.js";import{a as z}from"./chunk-NHNZC5T7.js";import"./chunk-KFQQY7Q4.js";import{a as J}from"./chunk-YRUNILEP.js";import{a as Y}from"./chunk-SX46PIGY.js";import"./chunk-SNFTPR3R.js";import"./chunk-ZS4G4JJV.js";import"./chunk-4QFA7BNO.js";import{$a as a,Aa as v,Oa as S,Pb as V,Qa as p,Qb as T,Rb as F,Ua as t,Va as r,Wa as _,Wb as I,Za as w,_ as E,_a as u,a as C,db as M,eb as o,fb as A,gb as b,ha as d,hb as N,ia as m,ja as f,jb as g,ka as y,kb as x,lb as h,nb as k,za as l}from"./chunk-CZ4BJCOO.js";function K(c,U){if(c&1){let e=w();t(0,"tr",15)(1,"td",16),o(2),r(),t(3,"td",16),o(4),r(),t(5,"td",16)(6,"span",17),o(7),r()(),t(8,"td",16)(9,"span",17),o(10),r()(),t(11,"td",16)(12,"button",18),u("click",function(){let i=d(e).$implicit,s=a();return m(s.editUser(i))}),f(),t(13,"svg",19),_(14,"path",20),r()(),y(),t(15,"button",21),u("click",function(){let i=d(e).$implicit,s=a();return m(s.toggleUserStatus(i))}),f(),t(16,"svg",19),_(17,"path",22),r()(),y(),t(18,"button",23),u("click",function(){let i=d(e).$implicit,s=a();return m(s.deleteUser(i))}),f(),t(19,"svg",19),_(20,"path",24),r()()()()}if(c&2){let e=U.$implicit,n=a();l(2),N("",e.firstName," ",e.lastName,""),l(2),A(e.email),l(2),p("ngClass",n.getRoleClass(e.role)),l(),b(" ",e.role," "),l(2),p("ngClass",e.enabled?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),l(),b(" ",e.enabled?"Actif":"Inactif"," ")}}function Q(c,U){if(c&1){let e=w();t(0,"div",25)(1,"div",26)(2,"h3",27),o(3),r(),t(4,"form",28,0),u("ngSubmit",function(){d(e);let i=a();return m(i.saveUser())}),t(6,"div",29)(7,"div")(8,"label",30),o(9,"Pr\xE9nom"),r(),t(10,"input",31),h("ngModelChange",function(i){d(e);let s=a();return x(s.currentUser.firstName,i)||(s.currentUser.firstName=i),m(i)}),r()(),t(11,"div")(12,"label",30),o(13,"Nom"),r(),t(14,"input",32),h("ngModelChange",function(i){d(e);let s=a();return x(s.currentUser.lastName,i)||(s.currentUser.lastName=i),m(i)}),r()(),t(15,"div")(16,"label",30),o(17,"Email"),r(),t(18,"input",33),h("ngModelChange",function(i){d(e);let s=a();return x(s.currentUser.email,i)||(s.currentUser.email=i),m(i)}),r()(),t(19,"div")(20,"label",30),o(21,"R\xF4le"),r(),t(22,"select",34),h("ngModelChange",function(i){d(e);let s=a();return x(s.currentUser.role,i)||(s.currentUser.role=i),m(i)}),t(23,"option",35),o(24,"\xC9tudiant"),r(),t(25,"option",36),o(26,"Entreprise"),r(),t(27,"option",37),o(28,"Facult\xE9"),r(),t(29,"option",38),o(30,"Administrateur"),r()()(),t(31,"div")(32,"label",30),o(33,"T\xE9l\xE9phone"),r(),t(34,"input",39),h("ngModelChange",function(i){d(e);let s=a();return x(s.currentUser.phoneNumber,i)||(s.currentUser.phoneNumber=i),m(i)}),r()()(),t(35,"div",40)(36,"button",41),u("click",function(){d(e);let i=a();return m(i.closeModal())}),o(37," Annuler "),r(),t(38,"button",42),o(39),r()()()()()}if(c&2){let e=M(5),n=a();l(3),b("",n.isEditing?"Modifier":"Ajouter"," utilisateur"),l(7),g("ngModel",n.currentUser.firstName),l(4),g("ngModel",n.currentUser.lastName),l(4),g("ngModel",n.currentUser.email),l(4),g("ngModel",n.currentUser.role),l(12),g("ngModel",n.currentUser.phoneNumber),l(4),p("disabled",!e.form.valid),l(),b(" ",n.isEditing?"Modifier":"Ajouter"," ")}}var oe=(()=>{class c{constructor(e,n){this.userService=e,this.notificationService=n,this.users=[],this.showModal=!1,this.isEditing=!1,this.currentUser=this.getEmptyUser()}ngOnInit(){this.loadUsers()}loadUsers(){this.userService.getAllUsers().subscribe({next:e=>{console.log("\u2705 Type de res.content:",typeof e.content),console.log("\u2705 instanceof Array:",e.content instanceof Array),console.log("\u2705 Array.isArray:",Array.isArray(e.content)),console.log("\u2705 Donn\xE9es:",e.content),this.users=Array.isArray(e.content)?e.content:[]},error:e=>{console.error("Erreur lors du chargement des utilisateurs:",e),this.notificationService.showError("Erreur lors du chargement des utilisateurs")}})}openAddUserModal(){this.isEditing=!1,this.currentUser=this.getEmptyUser(),this.showModal=!0}editUser(e){this.isEditing=!0,this.currentUser=C({},e),this.showModal=!0}saveUser(){this.isEditing&&this.currentUser.id?this.userService.updateUser(this.currentUser.id,this.currentUser).subscribe({next:()=>{this.loadUsers(),this.closeModal(),this.notificationService.showSuccess("Utilisateur modifi\xE9 avec succ\xE8s")},error:e=>{console.error("Erreur lors de la modification:",e),this.notificationService.showError("Erreur lors de la modification de l'utilisateur")}}):this.userService.createUser(this.currentUser).subscribe({next:()=>{this.loadUsers(),this.closeModal(),this.notificationService.showSuccess("Utilisateur cr\xE9\xE9 avec succ\xE8s")},error:e=>{console.error("Erreur lors de la cr\xE9ation:",e),this.notificationService.showError("Erreur lors de la cr\xE9ation de l'utilisateur")}})}deleteUser(e){confirm(`\xCAtes-vous s\xFBr de vouloir supprimer ${e.firstName} ${e.lastName} ?`)&&this.userService.deleteUser(e.id).subscribe({next:()=>this.loadUsers(),error:n=>console.error("Erreur lors de la suppression:",n)})}toggleUserStatus(e){console.log("Toggle status pour:",e)}closeModal(){this.showModal=!1,this.currentUser=this.getEmptyUser()}getRoleClass(e){return{STUDENT:"bg-blue-100 text-blue-800",COMPANY:"bg-green-100 text-green-800",FACULTY:"bg-purple-100 text-purple-800",ADMIN:"bg-red-100 text-red-800"}[e]||"bg-gray-100 text-gray-800"}getEmptyUser(){return{id:0,firstName:"",lastName:"",email:"",role:Y.STUDENT,enabled:!0,createdAt:"",updatedAt:"",phoneNumber:""}}static{this.\u0275fac=function(n){return new(n||c)(v(J),v(z))}}static{this.\u0275cmp=E({type:c,selectors:[["app-admin-users"]],standalone:!0,features:[k],decls:29,vars:2,consts:[["userForm","ngForm"],[1,"space-y-6"],[1,"bg-white","rounded-lg","shadow-sm","border","p-6"],[1,"text-2xl","font-bold","text-primary-900"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-lg","font-semibold","text-primary-900"],[1,"bg-primary-600","text-white","px-4","py-2","rounded-lg","hover:bg-primary-700",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-2","inline"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"overflow-x-auto"],[1,"w-full"],[1,"bg-primary-50"],[1,"px-4","py-3","text-left","text-primary-900"],["class","border-b border-primary-100",4,"ngFor","ngForOf"],["class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",4,"ngIf"],[1,"border-b","border-primary-100"],[1,"px-4","py-3"],[1,"px-2","py-1","rounded-full","text-sm",3,"ngClass"],[1,"text-primary-600","hover:text-primary-800","mr-2",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],[1,"text-orange-600","hover:text-orange-800","mr-2",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 9l4-4 4 4m0 6l-4 4-4-4"],[1,"text-red-600","hover:text-red-800",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"bg-white","rounded-lg","p-6","w-full","max-w-md"],[1,"text-lg","font-semibold","mb-4"],[3,"ngSubmit"],[1,"space-y-4"],[1,"block","text-sm","font-medium","text-gray-700"],["name","firstName","required","",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","px-3","py-2",3,"ngModelChange","ngModel"],["name","lastName","required","",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","px-3","py-2",3,"ngModelChange","ngModel"],["name","email","type","email","required","",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","px-3","py-2",3,"ngModelChange","ngModel"],["name","role","required","",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","px-3","py-2",3,"ngModelChange","ngModel"],["value","STUDENT"],["value","COMPANY"],["value","FACULTY"],["value","ADMIN"],["name","phoneNumber",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","px-3","py-2",3,"ngModelChange","ngModel"],[1,"flex","justify-end","space-x-2","mt-6"],["type","button",1,"px-4","py-2","text-gray-600","border","border-gray-300","rounded-md","hover:bg-gray-50",3,"click"],["type","submit",1,"px-4","py-2","bg-primary-600","text-white","rounded-md","hover:bg-primary-700","disabled:opacity-50",3,"disabled"]],template:function(n,i){n&1&&(t(0,"div",1)(1,"div",2)(2,"h1",3),o(3,"Gestion des utilisateurs"),r()(),t(4,"div",2)(5,"div",4)(6,"h2",5),o(7,"Liste des utilisateurs"),r(),t(8,"button",6),u("click",function(){return i.openAddUserModal()}),f(),t(9,"svg",7),_(10,"path",8),r(),o(11," Ajouter utilisateur "),r()(),y(),t(12,"div",9)(13,"table",10)(14,"thead",11)(15,"tr")(16,"th",12),o(17,"Nom"),r(),t(18,"th",12),o(19,"Email"),r(),t(20,"th",12),o(21,"R\xF4le"),r(),t(22,"th",12),o(23,"Statut"),r(),t(24,"th",12),o(25,"Actions"),r()()(),t(26,"tbody"),S(27,K,21,7,"tr",13),r()()()()(),S(28,Q,40,8,"div",14)),n&2&&(l(27),p("ngForOf",i.users),l(),p("ngIf",i.showModal))},dependencies:[I,V,T,F,q,P,H,R,W,B,L,j,G,O,D]})}}return c})();export{oe as AdminUsersComponent};
